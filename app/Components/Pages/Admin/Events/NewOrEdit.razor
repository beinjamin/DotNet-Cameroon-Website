@page "/admin/events/{Id:guid}"
@layout AdminLayout
@rendermode InteractiveServer
@attribute [StreamRendering]
@attribute [Authorize]

<PageTitle>Admin | Edit Event</PageTitle>
<h1 class="heading heading-1">Create or Update Events</h1>
<div class="flex gap-6">
    <EditForm Model="@Model" FormName="EventForm" class="w-1/2">
        <div>
            <h2 class="heading heading-2">Core informations</h2>
            <p></p>
            <div class="flex flex-col gap-4 items-start">
                <div class="w-full">
                    <label for="title-input" class="font-bold">
                        Title
                    </label>
                    <InputText id="title-input" class="p-2 w-full px-4 border border-gray-400 rounded-lg" @bind-Value="@Model.Title" title="title" required placeholder="The event name"/>
                </div>
                <div class="w-full">
                    <label for="description-input" class="font-bold">
                        Description
                    </label>
                    <InputTextArea id="description-input" class="p-2 w-full px-4 border border-gray-400 rounded-lg" @bind-Value="@Model.Description" title="description" required placeholder="The event description"/>
                </div>
            </div>
        </div>

        <div class="mt-6">
            <h2 class="heading heading-2">Partners</h2>
            <p>Use the dropdow to pick a partner. It will automatically register the one picked to the partners list, and later on you can remove it</p>
            <div class="relative flex mt-4">
                <select @onchange="@OnPartnerSelected" class="w-full">
                    <option value="">-- Choose a partner --</option>
                    @foreach(var partner in AllPartners)
                    {
                        <option value="@partner.Name">@partner.Name</option>
                    }
                </select>
            </div>
            <div class="flex flex-col mt-4 gap-2">
                @foreach(var partner in Model.Partners)
                {
                    <div class="flex items-center w-full gap-4">
                        <img src="@partner.Logo" alt="@partner.Name" class="block w-[60px] h-[30px] object-cover">
                        <div class="flex justify-between items-center w-[calc(100%-50px)]">
                            <p class="font-bold">@partner.Name</p>
                            <button class="btn btn-primary" @onclick="() => RemovePartner(partner)">Remove</button>
                        </div>
                    </div>
                }
            </div>
        </div>
        <div class="flex mt-6 gap-4">
            <a href="/admin" class="btn btn-secondary"><i class="fa-solid fa-xmark"></i> Discard</a>
            <button class="btn btn-primary center" type="submit"><i class="fa-solid fa-check"></i> Save</button>
        </div>
    </EditForm>
    <div>
        <div class="flex">
            <img src="@Model.ImageUrl" alt="@Model.Title"/>
        </div>
    </div>
</div>
